@model Docker_Compose_Generator.Models.NetworkDTO

<div class="network-editor card mb-3 shadow-sm">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Network Configuration</h5>
        <button type="button" class="btn-close" aria-label="Remove" onclick="$(this).closest('.network-editor').remove();"></button>
    </div>
    <div class="card-body">
        <div class="mb-3">
            <label asp-for="Name" class="form-label">Network Name</label>
            <input asp-for="Name" class="form-control" placeholder="Enter network name" />
            <span asp-validation-for="Name" class="text-danger"></span>
        </div>
        <div class="mb-3">
            <label asp-for="Driver" class="form-label">Driver</label>
            <select asp-for="Driver" class="form-select">
                <option value="">Default</option>
                <option value="bridge">Bridge</option>
                <option value="host">Host</option>
                <option value="overlay">Overlay</option>
                <option value="none">None</option>
            </select>
        </div>
        <div class="mb-3 form-check">
            <input asp-for="Internal" class="form-check-input" type="checkbox" />
            <label asp-for="Internal" class="form-check-label">Internal</label>
        </div>
        <div class="mb-3 form-check">
            <input asp-for="Attachable" class="form-check-input" type="checkbox" />
            <label asp-for="Attachable" class="form-check-label">Attachable</label>
        </div>
        <div>
            <h6 class="mt-4">IPAM Configuration</h6>
            <div class="mb-3">
                <label asp-for="Ipam.Driver" class="form-label">IPAM Driver</label>
                <input asp-for="Ipam.Driver" class="form-control" placeholder="Enter IPAM driver (optional)" />
            </div>
            <div class="ipam-config-list">
                <!-- Placeholder for dynamically added IPAM Configurations -->
                @if (Model.Ipam?.Configurations != null)
                {
                    foreach (var ipamConfig in Model.Ipam.Configurations)
                    {
                        <div class="ipam-config mb-3 border p-3 rounded">
                            <div class="d-flex justify-content-between">
                                <h6>IPAM Configuration</h6>
                                <button type="button" class="btn-close" onclick="$(this).closest('.ipam-config').remove();"></button>
                            </div>
                            <div class="mb-2">
                                <label>Subnet</label>
                                <input type="text" class="form-control" name="Ipam.Configurations[].Subnet" value="@ipamConfig.Subnet" placeholder="Enter subnet" />
                            </div>
                            <div class="mb-2">
                                <label>Gateway</label>
                                <input type="text" class="form-control" name="Ipam.Configurations[].Gateway" value="@ipamConfig.Gateway" placeholder="Enter gateway" />
                            </div>
                        </div>
                    }
                }
                <button type="button" class="btn btn-outline-primary mb-3" onclick="addIpamConfig(this)">Add IPAM Config</button>
            </div>
        </div>
        <div>
            <h6 class="mt-4">Driver Options</h6>
            <div class="driver-options-list">
                <!-- Placeholder for dynamically added Driver Options -->
                @if (Model.DriverOptions != null)
                {
                    foreach (var option in Model.DriverOptions)
                    {
                        <div class="driver-option mb-3 border p-3 rounded">
                            <div class="d-flex justify-content-between">
                                <h6>Driver Option</h6>
                                <button type="button" class="btn-close" onclick="$(this).closest('.driver-option').remove();"></button>
                            </div>
                            <div class="mb-2">
                                <label>Key</label>
                                <input type="text" class="form-control" name="DriverOptions.Keys[]" value="@option.Key" placeholder="Option key" />
                            </div>
                            <div class="mb-2">
                                <label>Value</label>
                                <input type="text" class="form-control" name="DriverOptions.Values[]" value="@option.Value" placeholder="Option value" />
                            </div>
                        </div>
                    }
                }
                <button type="button" class="btn btn-outline-primary mb-3" onclick="addDriverOption(this)">Add Driver Option</button>
            </div>
        </div>
    </div>
</div>

<script>
    function addIpamConfig(button) {
        const configHtml = `
            <div class="ipam-config mb-3 border p-3 rounded">
                <div class="d-flex justify-content-between">
                    <h6>IPAM Configuration</h6>
                    <button type="button" class="btn-close" onclick="$(this).closest('.ipam-config').remove();"></button>
                </div>
                <div class="mb-2">
                    <label>Subnet</label>
                    <input type="text" class="form-control" name="Ipam.Configurations[].Subnet" placeholder="Enter subnet" />
                </div>
                <div class="mb-2">
                    <label>Gateway</label>
                    <input type="text" class="form-control" name="Ipam.Configurations[].Gateway" placeholder="Enter gateway" />
                </div>
            </div>`;
        $(button).closest('.ipam-config-list').append(configHtml);
    }

    function addDriverOption(button) {
        const optionHtml = `
            <div class="driver-option mb-3 border p-3 rounded">
                <div class="d-flex justify-content-between">
                    <h6>Driver Option</h6>
                    <button type="button" class="btn-close" onclick="$(this).closest('.driver-option').remove();"></button>
                </div>
                <div class="mb-2">
                    <label>Key</label>
                    <input type="text" class="form-control" name="DriverOptions.Keys[]" placeholder="Option key" />
                </div>
                <div class="mb-2">
                    <label>Value</label>
                    <input type="text" class="form-control" name="DriverOptions.Values[]" placeholder="Option value" />
                </div>
            </div>`;
        $(button).closest('.driver-options-list').append(optionHtml);
    }
</script>

<style>
    .network-editor {
        border: 1px solid #ddd;
        border-radius: 8px;
    }
    .card-header {
        background-color: #f8f9fa;
    }
    .btn-close {
        cursor: pointer;
    }
</style>
